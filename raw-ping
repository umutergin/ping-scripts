#!/usr/bin/python
import socket

socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
socket.connect(("192.168.1.1", 80)) # soket baglantinin yapilacagi ip ve port
print "We made a socket connection, looking good."



ipHeader = [0xa7, 
            0x00, 
            0x02, 0x54, 
            0x80, 0xa6, 
            0x10, 0x00, 
            0x20, 
            0x02, 
            0x23, 0x3b, # checksum degeri
            0xc0, 0xa8, 0x01, 0x62, # 192.168.1.98  kaynak ip
            0xc0, 0xa8, 0x01, 0x01] # 192.168.1.1   hedef ip

icmpHeader = [0x08, 
            0x00, 
            0xc2, 0x4d, # checksum degeri
            0x00, 0x01, 
            0xc0, 0x04, 
            0xab, 0x5c, 0x8a, 0x54, 0x32, 0x45, 0x33, 0x00]

icmpData = [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            0x00, 0x00, 0x00, 0x06, 0x05, 0x04, 0x03, 0x02]

ipHeaderString = "".join(map(chr, ipHeader))
icmpHeaderString = "".join(map(chr, icmpHeader)) 
icmpDataString = "".join(map(chr, icmpData))


payload = ipHeaderString + icmpHeaderString + icmpDataString

socket.sendall(payload)

print "Sent ' " + payload + " ' as a packet."
